<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Image Network</title>
	</head>
	<style>
		.newResult {
			padding-left: 15px;
			padding-top: 15px;
			background-color: #e9ebee;
			border-bottom: 1px solid #d3d3d3;
		}
		
		#username {
			width: 300px;
		}
	</style>
	<body>
		<div id="main">
			<div id="form" style="background-color: #fff;">
				<input id="username" type="text" name="username" autocomplete="off" placeholder="Username" onchange="search()" 
				onkeyup="this.onchange()" onpaste="this.onchange()" oninput="this.onchange()"/>
			</div>
			<div id="result" style="width: 300px;">
				
			</div>
		</div>
		<!-- MARK: Firebase scripts -->
		<script src="https://www.gstatic.com/firebasejs/3.7.2/firebase.js"></script>
		<script>
		  // Initialize Firebase
		  var config = {
		    apiKey: "AIzaSyBXwd0A6u5uWUHX9GxiT-TcwkAac_X-Wx4",
		    authDomain: "image-network.firebaseapp.com",
		    databaseURL: "https://image-network.firebaseio.com",
		    storageBucket: "image-network.appspot.com",
		    messagingSenderId: "268082674497"
		  };
		  firebase.initializeApp(config);
		  
	
	      // Call initApp() upon the window loading
	      window.onload = function() {

	      }
	      
	      function search() {
	    	  var input = document.getElementById('username').value;
	    	  var result = document.getElementById('result');
	    	  var users;
	    	  var ref = firebase.database().ref();
	    	  ref.child('users').orderByChild('username').once('value').then(function(snapshot) {
	    		 if (snapshot) {
	    			 users = snapshot.val();
	    			 if (input == '') {
	    				 while (result.firstChild) {
	    					 result.removeChild(result.firstChild);
	    				 }
	    				 return;
	    			 }
	    			 while (result.firstChild) {
    					 result.removeChild(result.firstChild);
    				 }
	    			 for (var key in users) {
		    			 if ((users[key].username.toLowerCase().includes(input.toLowerCase()) || 
		    					 users[key].fullname.toLowerCase().includes(input.toLowerCase())) && input != '') {
							 var focus = users[key];
		    				 var newResult = document.createElement('div');
		    				 newResult.className = 'newResult';
		    				 newResult.innerHTML = focus.fullname + '<br><span style="color: green; font-size: 0.9em;">@' + focus.username + '</span><br><br>';
		    				 result.appendChild(newResult);
		    			 }
		    		 }
	    		 } 
	    	  }).catch(function(error) {
	    		  
	    	  });
	      }
		</script>
	</body>
</html>